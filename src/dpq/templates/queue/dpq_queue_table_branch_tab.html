<script>
    $('a.prevent-default').click(function (event) {
        event.preventDefault();
    });
</script>

<table class="table table-condensed">
    <thead>
    <tr>
        <th id="arrow-up"></th>
        <th style="text-align: center;">#</th>
        <th id="arrow-down"></th>
        <th style="width: 50px;">PS</th>
        <th>Developers</th>
        <th>Tester</th>
        <th>Description</th>
        <th style="width: 100px;">Created</th>
        <th style="width: 6px;"></th>
        <th style="width: 6px;"></th>
        <th style="width: 6px;"></th>
        <th style="width: 80px;">Status</th>
    </tr>
    </thead>
    <tbody>
    {% if data.push_table %}
        {% for item in data.push_table %}
            <tr {% if item.status == item.IN_PROGRESS %} class="warning"{% endif %}>
                <td>
                    {% if user.is_superuser or item.owner == user %}
                        {% if item.index != data.last_item %}
                            <a class="prevent-default move-link" href="#"
                               onclick="moveRecord('{{ item.queue_id }}', 'up')" title="Move up"><b>↑</b></a>
                        {% endif %}
                    {% endif %}
                </td>
                <td style="text-align: center;">
                    {{ item.index }}
                </td>
                <td>
                    {% if user.is_superuser %}
                        {% if item.index != data.first_item %}
                            <a class="prevent-default move-link" href="#"
                               onclick="moveRecord('{{ item.queue_id }}', 'down')" title="Move down"><b>↓</b></a>
                        {% endif %}
                    {% endif %}
                </td>
                <td style="border-left: 1px;">{{ item.ps }}</td>
                <td><i class="{{ item.team.css_icon }}" title="{{ item.team.name }} Team"></i>
                    {{ item.developerA }}{% if item.developerB != "" %}, {{ item.developerB }}{% endif %}</td>
                <td>{{ item.tester }}</td>
                <td title="{{ item.description }}">{{ item.description|truncatechars:70 }}</td>
                <td>{{ item.creation_date|date:"M j, H:i" }}</td>
                <td>{% if item.owner == user or user.is_superuser %}
                    {% if item.status != item.DONE and item.status != item.REVERTED %}
                        <a href="#dpq-modify-queue" data-toggle="modal" title="Modify record"
                           onclick="fetchQueueObject('{{ item.queue_id }}')"> <i class="icon-wrench"></i>
                        </a> {% endif %} {% endif %}
                </td>
                <td><a href="#dpq-push-details" style="text-decoration: none;"
                       data-toggle="modal" title="View detailed info"
                       onclick="fetchPushDetails('{{ item.queue_id }}')"><i class="icon-info-sign"></i></a>
                </td>
                <td>{% if item.codereview_url != "" %}
                    <a href="{{ item.codereview_url }}" target="_blank" title="View commit on GitHub">
                        <i class="icon-comment"></i></a>
                {% endif %}
                </td>
                <td><span {% if item.status == item.IN_PROGRESS %} class="label label-warning"{% endif %}>
                    {{ item.get_status_display }}
                    </span>
                </td>
            </tr>
        {% endfor %}
    {% else %}
        <tr>
            <td colspan="12" style="text-align: center; padding-top: 20px;">
                No way! Looks like queue for branch {{ branch }} is empty. Be the first to add your push to the queue!
            </td>
        </tr>
    {% endif %}
    </tbody>
</table>
